---
// TocMobile - 移动端目录悬浮按钮和抽屉组件
---

<!-- 移动端目录悬浮按钮 -->
<button
    class="mobile-toc-btn mobile-only"
    id="toc-float-btn"
    aria-label="文章目录"
>
    <svg
        xmlns="http://www.w3.org/2000/svg"
        width="20"
        height="20"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <line x1="8" y1="6" x2="21" y2="6"></line>
        <line x1="8" y1="12" x2="21" y2="12"></line>
        <line x1="8" y1="18" x2="21" y2="18"></line>
        <line x1="3" y1="6" x2="3.01" y2="6"></line>
        <line x1="3" y1="12" x2="3.01" y2="12"></line>
        <line x1="3" y1="18" x2="3.01" y2="18"></line>
    </svg>
</button>

<!-- 移动端目录抽屉 -->
<div class="mobile-toc-overlay" id="toc-overlay"></div>
<div class="mobile-toc-drawer" id="toc-drawer">
    <div class="drawer-header">
        <span class="drawer-title">文章目录</span>
        <button
            class="drawer-close"
            id="toc-drawer-close"
            aria-label="关闭"
        >
            <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
            >
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
        </button>
    </div>
    <nav class="drawer-content" id="mobile-toc"></nav>
</div>

<style is:global>
    /* ====== 移动端目录悬浮按钮和抽屉样式 ====== */
    @media (max-width: 1399px) {
        .mobile-toc-btn {
            position: fixed;
            top: 5rem;
            right: 1rem;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: white;
            border: 1px solid var(--border-color);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .mobile-toc-btn:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transform: scale(1.05);
        }

        .mobile-toc-btn svg {
            width: 24px;
            height: 24px;
            color: #666;
        }
    }

    .mobile-toc-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        z-index: 200;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
    }

    /* 桌面端隐藏移动端目录组件 */
    @media (min-width: 1400px) {
        .mobile-toc-overlay,
        .mobile-toc-drawer {
            display: none !important;
        }
    }

    .mobile-toc-overlay.visible {
        opacity: 1;
        visibility: visible;
    }

    .mobile-toc-drawer {
        position: fixed;
        top: 0;
        right: 0;
        width: 280px;
        max-width: 80vw;
        height: 100vh;
        background: white;
        z-index: 201;
        transform: translateX(100%);
        transition:
            transform 0.3s ease,
            visibility 0.3s ease;
        display: flex;
        flex-direction: column;
        box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1);
        visibility: hidden;
    }

    .mobile-toc-drawer.open {
        transform: translateX(0);
        visibility: visible;
    }

    .drawer-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 1rem;
        border-bottom: 1px solid var(--border-color);
        flex-shrink: 0;
    }

    .drawer-title {
        font-weight: 600;
        font-size: 1rem;
        color: #333;
    }

    .drawer-close {
        background: none;
        border: none;
        cursor: pointer;
        padding: 0.25rem;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #666;
        transition: color 0.2s;
    }

    .drawer-close:hover {
        color: #333;
    }

    .drawer-close svg {
        width: 20px;
        height: 20px;
    }

    .drawer-content {
        flex: 1;
        overflow-y: auto;
        padding: 1rem;
    }

    /* 移动端目录样式 */
    #mobile-toc ul {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    #mobile-toc li {
        margin: 0;
        line-height: 1;
    }

    #mobile-toc a {
        text-decoration: none;
        color: #666;
        font-size: 0.95rem; /* Larger touch targets */
        display: block;
        padding: 0.8rem 1rem;
        border-left: 3px solid transparent;
        transition: all 0.2s;
    }

    #mobile-toc a:hover {
        color: var(--primary-color, #ff9eb5);
        border-left-color: var(--primary-color, #ff9eb5);
        background: var(--primary-subtle, rgba(255, 158, 181, 0.1));
    }

    #mobile-toc a.active {
        color: var(--primary-color, #ff9eb5);
        font-weight: 600;
        border-left-color: var(--primary-color, #ff9eb5);
        background: var(--primary-subtle, rgba(255, 158, 181, 0.1));
    }

    /* 移动端目录层级缩进 */
    #mobile-toc .level-1 a {
        padding-left: 1rem;
    }
    #mobile-toc .level-2 a {
        padding-left: 2rem;
    }
    #mobile-toc .level-3 a {
        padding-left: 3rem;
        font-size: 0.85rem;
    }
    #mobile-toc .level-4 a {
        padding-left: 4rem;
        font-size: 0.85rem;
    }
</style>
