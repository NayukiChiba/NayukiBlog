---
/**
 * CDN 资源预加载组件
 * 在页面加载完成后，后台预加载 Markdown 文章所需的 CDN 资源
 * 这样用户导航到文章页面时可以直接使用缓存
 */
---

<script is:inline>
  // 页面完全加载后执行预加载
  window.addEventListener("load", function () {
    // 延迟 100ms 确保不影响主要内容渲染
    setTimeout(function () {
      // 需要预加载的 CDN 资源列表
      var cdnResources = [
        // KaTeX 数学公式样式
        {
          type: "style",
          url: "https://cdn.staticfile.net/KaTeX/0.16.9/katex.min.css",
        },
      ];

      // 遍历资源列表并创建 prefetch 链接
      cdnResources.forEach(function (resource) {
        var link = document.createElement("link");
        link.rel = "prefetch";
        link.href = resource.url;
        link.crossOrigin = "anonymous";

        // 根据资源类型设置 as 属性
        if (resource.type === "style") {
          link.as = "style";
        } else if (resource.type === "script") {
          link.as = "script";
        }

        document.head.appendChild(link);
      });

      // 调试日志（生产环境可移除）
      if (typeof console !== "undefined" && console.log) {
        console.log(
          "[CdnPreloader] 已预加载 " + cdnResources.length + " 个 CDN 资源",
        );
      }
    }, 100);
  });
</script>
